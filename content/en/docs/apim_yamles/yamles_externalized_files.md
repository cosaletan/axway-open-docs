{
"title": "Manage externalized files",
"linkTitle": "Manage externalized files",
"weight":"60",
"date": "2020-09-24",
"description": "Learn how to work with externalized files within YAML configuration."
}

Note that is topic is unrelated to [Environmentalization](/docs/apim_yamles/yamles_environmentalization).

Some entities have fields that contain the content of a file, for example a script, or a certificate. In the XML federated configuration, these files were embedded within the XML making them hard to edit in an editor more suited to the file content. In a YAML configuration, the content of these files is stored in separate external files. This provides the following advantages:

* They can be easily read without unnecessary encoding.
* You can create and edit these files using a text editor (IDE) of your choice.

This an example:

```yaml
---
type: FilterCircuit
fields:
  name: Get organizationId
children:
- type: ChangeMessageFilter
  fields:
    name: Set Backend message
    outputContentType: application/json
    body#ref: Get organizationId - Set Backend message.json # the message has been externalized
                                                            # field "body" has been renamed in "body#ref"
```

Content of `Get organizationId - Set Backend message.json`:

```json
{
  "name": "${targetName}",
  "serviceType": "rest",
  "description": "Streamed backend",
  "version": "1.0",
  "basePath": "https://${StreamsSSEVHOST}",
  "resourcePath": "/subscribers",
  "models": {},
  "consumes": [],
  "produces": [],
  "organizationId": "${backend.organizationId}"
}
```

The location of an externalized file is always relative to the directory of the YAML file referencing it. In the above example, both files are in the same directory.

{{< alert title="Note">}}You can name your external file as you wish. As for any YAML file not named after its entity key fields, if the entity is modified by ES Explorer, or via the Entity Store API, it will be renamed using the default naming scheme.{{< /alert >}}

## Externalized files naming scheme

| Entity (as named in Policy Studio) | EntityType | Field | Externalized file name scheme | Possible extensions | Additional rules | Environmentalization possible inside file content |
| --- | --- | --- | --- | --- | --- | --- |
| Script language / Scripts (in Resources) | `JavaScriptFilter`, `Script` | `script#ref` | `<Parent entity>-Scripts/<entity field "name">` | `.groovy`, `.js`, `.nashorn.js`, `.py` |  | Yes |
| Set Message (Policy Filter) | FilterCircuit | `body#ref` | `<Parent entity>-<entity field "name">` | `.json`, `.html`, `.xml`, `.txt` | Only multi-line body is externalize. Extension depends on content type content. | Yes |
| JSON Schema | `JSONSchema` | `contents#ref` | `<entity field "name">` | `.json` |  | Yes |
| Certificate | `Certificate` | `content#ref` | `<entity field "dname">-cert` | `.pem` | [How to add a new certificate](/docs/apim_yamles/yamles_edit/#how-to-add-a-new-certificate-and-private-key-to-a-yaml-configuration) | No |
|             |               | `key#refbinay` | `<entity field "dname">-key` | `.pem` | [How to add a private key](/docs/apim_yamles/yamles_edit/#how-to-add-a-new-certificate-and-private-key-to-a-yaml-configuration) | No |
| XML Schema Document Bundles / WSDL Document Bundles | `ResourceBlob` | `content#binary` | `<entity fields "ID">` (generated by Policy Studio but can be manually set) | `.xsd`, `.dtd`, `.wsdl` | Extension depends on content on type | No |
| Alert type → OPSEC → Files to upload | `UpLoadFile` | `contents#binary` | `upload-files/<entity fields "name">` | n/a | Entity name is the file name. | No |
| PGP Key Pairs | PGPKeyPairs | `publicKey#binary`  | `<entity field "alias">-pub` | `.crt` |  | No |
|               |             | `privateKey#binary` | `<entity field "alias">-sec` | `.asc` |  | No |
| Tivoli Connection | TivoliSettings | `configDatabaseFile#binary` | `<entity field "name">` | `.db.conf`   | Tivoli Configuration Database File. | No |
|                   |                | `sslStashFile#binary`       | `<entity field "name">` | `.ssl.key`   | SSL Stash file                      | No |
|                   |                | `sslKeyFile#binary`         | `<entity field "name">` | `.ssl.stash` | SSL Key file                        | No |

{{< alert title="Note">}}`#ref` and `#refbinary` naming convention might evolve in the future.{{< /alert >}}
